#! /bin/bash

bold=$(tput bold)
normal=$(tput sgr0)

boldEcho() {
  echo "${bold}$1${normal}" 
}

if [ -z "$(git status --porcelain)" ]; then 
  echo
  boldEcho "Resetting staging to main branch..."
  echo
  boldEcho "-> Updating local main branch"
  git switch main
  git pull origin
  echo
  boldEcho "-> Recreating staging from main"
  git branch -D staging
  git switch -c staging
  echo
  boldEcho "-> Force pushing new staging branch"
  git push origin staging -f
  echo
  boldEcho "DONE!"
  echo
else 
  boldEcho "You have changes in your working directory."
  boldEcho "Commit or stash them before running this command."
  exit 1
fi
